{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Intro","text":"<p>Field sequencing outside a lab environment has been made possible by Oxford Nanopore technologies. Combining the portable sequencer called 'MinION Mk1B' and a powerfull laptop (incl. GPU power) one is able to perform in field sequencing and real-time data analysis. The idea of this website is to setup a portable field sequencing workflow covering following topics:  </p> <ul> <li>GPU system setup  </li> <li>Installing software (including ONT sequencing software)  </li> <li>Using <code>BLAST</code>and different databases for taxonomical ID  </li> <li>Wet lab approach for barcoding applications</li> <li>Demo of our field sequencing test at Botanic Garden Ghent  </li> </ul> <p>This is a step by step guide that will empower you to set up a compute workstation and learn all necessary protocols for both wet and dry lab.</p>"},{"location":"nanopore-tools/","title":"Nanopore Tools","text":"<p>All nanopore proprietary software can be found in the software &amp; Download section on the website of nanopore.   </p>"},{"location":"nanopore-tools/#sequencing-minkow","title":"Sequencing: Minkow","text":"<p>The basic setup for sequencing in the software package called <code>Minknow</code>. Minknow can both operate the sequencing device as well as running real time basecalling. The installation guide provided in the the software &amp; Download section gives you an overview of all necessary commands to issue for installing the software.  </p>"},{"location":"nanopore-tools/#default-installation-directories","title":"Default installation directories","text":"<ol> <li>For the MinKNOW software: <code>/opt/ont/minknow</code> </li> <li>For the MinKNOW user interface: <code>/opt/ont/minknow-ui</code> </li> <li>Location of the reads folder: <code>/var/lib/minknow/data</code> </li> <li>Location of the log files: The MinKNOW logs are located in <code>/var/log/minknow</code> The Dorado basecaller logs are located in <code>/var/log/dorado</code> </li> </ol>"},{"location":"nanopore-tools/#run-minknow-as-root","title":"Run Minknow as root","text":"<p>When running minknow you'll notice that when issuing another path for your reads folder, minkow will issue an error. Redirecting output from the standard <code>/var/lib/minknow/data</code> might be necessary when you run out of diskspace or simply when you prefer to output your data elsewhere. To enable this, you'll need to give the <code>minknow.service</code> writing privileges i.e. make this root. Make minknow.service root<pre><code>        $ sudo service minknow stop\n        $ sudo perl -i -pe 's/(User|Group)=minknow/$1=root/'/lib/systemd/system/minknow.service\n        $ sudo systemctl daemon-reload\n        $ sudo service minknow start\n</code></pre></p>"},{"location":"nanopore-tools/#basecalling-dorado","title":"Basecalling: Dorado","text":"<p>Dorado is a high-performance, easy-to-use, open source basecaller for Oxford Nanopore reads. The tool can be installed as a stand alone tool which provides more functionalities than basecalling in Minknow. You can find the Dorado github repo here.  </p>"},{"location":"nanopore-tools/#dorado-features","title":"Dorado features","text":"<ol> <li>Download model modules are not packed in the software <pre><code>dordado download --list\n</code></pre></li> <li>Basecaller <pre><code>dorado basecaller dna_r10.4.1_e82_400bps_fast@v4.1.0 ./input_pod5/ &gt; output.bam\ndorado basecaller dna_r10.4.1_e82_400bps_fast@v4.1.0 ./input_pod5/ --emit-fastq &gt; output.fastq\ndorado basecaller dna_r10.4.1_e82_400bps_fast@v4.1.0 ./input_pod5/ --emit-sam &gt; output.sam\n</code></pre></li> <li>Aligner <pre><code>dorado basecaller -x cuda:0 --reference .your-reference.fasta dna_r10.4.1_e8_400bps_fast@v4.1.0 ./pod5 &gt; aligned.bam\n</code></pre></li> <li>Sequencing summary generation <pre><code>dorado summary ./reads.bam &gt; sequencing_summary.txt\n</code></pre></li> </ol>"},{"location":"system-build/","title":"System setup","text":""},{"location":"system-build/#operating-system","title":"Operating system","text":"<p>Release: Ubuntu 22.04.4 LTS (Jammy Jellyfish) Follow this link to learn all you need to know on how to install ubuntu.</p>"},{"location":"system-build/#gpu-cuda","title":"GPU &amp; CUDA","text":"<p>GPU computational power increased ONT basecalling speed and enabled real-time data analysis. Upon writing this documentation dorado 0.7 is the current basecaller which is also incorperated in the sequencing operating software Minknow. Before we get to the installation of dedicated sequencing software and other data analys packages we will focus on installing a GPU and the CUDA toolkit.  </p>"},{"location":"system-build/#installation-on-ubuntu","title":"Installation on Ubuntu","text":"<ul> <li>Add graphics drivers ppa repo <pre><code>sudo add-apt-repository ppa:graphics-drivers/ppa\n</code></pre></li> <li>Install Ubuntu drivers app <pre><code>sudo apt install ubuntu-drivers-common\n</code></pre></li> <li>Check available GPUs <pre><code>ubuntu-drivers devices\n</code></pre> Example output<pre><code>== /sys/devices/pci0000:00/0000:00:01.0/0000:01:00.0 ==\nmodalias : pci:v000010DEd000027E0sv00001025sd0000166Cbc03sc00i00\nvendor   : NVIDIA Corporation\ndriver   : nvidia-driver-545-open - distro non-free\ndriver   : nvidia-driver-555-open - third-party non-free\ndriver   : nvidia-driver-550 - third-party non-free\ndriver   : nvidia-driver-550-open - third-party non-free\ndriver   : nvidia-driver-545 - distro non-free\ndriver   : nvidia-driver-535 - third-party non-free\ndriver   : nvidia-driver-555 - third-party non-free recommended\ndriver   : nvidia-driver-535-server - distro non-free\ndriver   : nvidia-driver-535-open - distro non-free\ndriver   : nvidia-driver-535-server-open - distro non-free\ndriver   : nvidia-driver-525 - third-party non-free\ndriver   : xserver-xorg-video-nouveau - distro free builtin\n</code></pre></li> <li>Install latest Nvidia driver (change <code>555</code> with latest version available in your case) <pre><code>sudo apt install nvidia-driver-525\n</code></pre></li> <li>Reboot your computer  </li> <li>Check if Nvidia driver and CUDA is available after reboot <pre><code>nvidia-smi\n</code></pre> Example output<pre><code>+---------------------------------------------------------------------------------------+\n| NVIDIA-SMI 545.29.06              Driver Version: 545.29.06    CUDA Version: 12.3     |\n|-----------------------------------------+----------------------+----------------------+\n| GPU  Name                 Persistence-M | Bus-Id        Disp.A | Volatile Uncorr. ECC |\n| Fan  Temp   Perf          Pwr:Usage/Cap |         Memory-Usage | GPU-Util  Compute M. |\n|                                         |                      |               MIG M. |\n|=========================================+======================+======================|\n|   0  NVIDIA GeForce RTX 4080 ...    Off | 00000000:01:00.0 Off |                  N/A |\n| N/A   45C    P8               1W /  90W |   1032MiB / 12282MiB |      0%      Default |\n|                                         |                      |                  N/A |\n+-----------------------------------------+----------------------+----------------------+\n\n+---------------------------------------------------------------------------------------+\n| Processes:                                                                            |\n|  GPU   GI   CI        PID   Type   Process name                            GPU Memory |\n|        ID   ID                                                             Usage      |\n|=======================================================================================|\n+---------------------------------------------------------------------------------------+\n</code></pre></li> </ul> <p>This output tells us we have a NVIDIA GeForce RTX 4080 running (12GB virtual RAM) and CUDA Version 12.3 has been co-installed.  </p>"},{"location":"system-build/#purge-nvidia","title":"Purge Nvidia","text":"<p>On some occasions you'll need to perform a fresh installation of nvidia drivers. It is important to purge all currently installed NVIDIA/CUDA before installing anew. Here is a step by step guide on how to do this:  </p> <ul> <li>List all packages The dpkg -l command is used in Debian-based Linux distributions to list all the installed packages. This command provides detailed information about each package, including its status, name, version, and a brief description. <pre><code>dpkg -l\n</code></pre> The output of dpkg -l, the columns represent:  </li> </ul> <ol> <li>Package status (e.g., \"ii\" for installed, \"un\" for uninstalled, etc.)  </li> <li>Package name  </li> <li>Version  </li> <li>Architecture  </li> <li>Description  </li> </ol> <ul> <li>List and purge all NVIDIA/CUDA  </li> </ul> <p><pre><code>sudo apt-get purge $(dpkg -l | grep '^ii.*nvidia'| awk '{print $2}')\n</code></pre> Description<pre><code>dpkg -l | grep '^ii.*nvidia'    # This command lists all installed packages (output of dpkg -l) that have \"nvidia\" in their names and are in the \"installed\" state (lines starting with \"ii\").  \n\nawk '{print $2}'                # This command uses awk to print the second column (package names) from the output of the previous command.  \n\nsudo apt-get purge $(...)       # This command uses command substitution to execute the inner command and pass its output (list of package names) as arguments to apt-get purge, which removes the specified packages.  \n</code></pre></p> <p>.</p>"},{"location":"system-build/#system-software","title":"System Software","text":"<p>On Ubuntu system applications can be installed using the graphical user interface (GUI). More information on how to install software on Ubuntu click here.  </p>"},{"location":"system-build/#bioinformatic-software","title":"Bioinformatic software","text":"<p>Usually bioinformatic software are opensource packages with installation instructions described on Github repositories. First thing you can do is get yourself a github account and get familiarized with github. Executable scripts are often found in the <code>/bin</code>folder, or can be installed in <code>/usr/local/bin</code> or in a dedicated bioinfo folder <code>/usr/local/bioinf/</code>. In the next section I will explain how to install the basecalling tool Dorado in the <code>/bioinf</code>folder and put the script on <code>PATH</code>.  </p> <ul> <li>Goto DORADO GITHUB </li> <li>Download the relevant installer for your platform (like described in the instructions)  </li> <li>Extract the archive to the desired location Extract and put on PATH<pre><code>1. mkdir /usr/local/bioinf/\n2. cd /usr/local/bioinf/\n3. wget https://cdn.oxfordnanoportal.com/software/analysis/dorado-0.7.2-linux-x64.tar.gz\n4. tar -xzvf dorado-0.7.2-linux-x64.tar.gz\n    # after unzipping, the main folder will contain a /bin and /lib folder.\n5. cd bin  \n6. ls\n    # /usr/local/bioinf/dorado/bin/dorado =&gt; this is the Executable file \n7. sudo ln -s /usr/local/bioinf/dorado/bin/dorado /usr/local/bin/dorado\n    # this will symlink the dorado script to /usr/local/bin/dorado\n8. echo 'export PATH=$PATH:/usr/local/bin' | sudo tee -a /etc/profile &amp;&amp; export PATH=$PATH:/usr/local/bin\n    # put in path if not by default, you can check by `echo $PATH`\n</code></pre> Following these instructions you should have downloaded the dorado script and it's libraries in the designated <code>/usr/local/bioinf</code> folder. To make the executable file accessible for all users you need to put it in PATH.</li> </ul>"},{"location":"system-build/#python-environments","title":"Python environments","text":"<p>When you need to install packages using the command <code>pip</code> it is adviced to do so in a separate python environment to avoid issues with the already existing python installation supporting your operating system. Detailed information on python venv can be found here.  </p>"},{"location":"system-build/#conda","title":"Conda","text":"<p>Yet another packaging and environmanagement tool is Conda. A lot of bioinformatic software has been made available in dedicated conda environments. Read all there is to know on how to use conda here. </p>"},{"location":"workflows/","title":"Workflows","text":"<p>EPI2ME Labs maintains a collection of bioinformatics workflows tailored to Oxford Nanopore Technologies long-read sequencing data. They are curated and actively maintained by experts in long-read sequence analysis. Read all about EPI2ME workflows here.  </p>"},{"location":"workflows/#installation-guide","title":"Installation guide","text":""},{"location":"workflows/#java","title":"JAVA","text":"<pre><code>sudo apt-get update\nsudo apt-get install default-jre #install java on ubuntu\n</code></pre>"},{"location":"workflows/#nextflow","title":"NEXTFLOW","text":"<pre><code>curl -s https://get.nextflow.io | bash # install nextflow\n</code></pre>"},{"location":"workflows/#go","title":"GO","text":"<pre><code># Install\n    export VERSION=1.11 OS=linux ARCH=amd64 &amp;&amp; \\\n    wget https://dl.google.com/go/go$VERSION.$OS-$ARCH.tar.gz &amp;&amp; \\\n    sudo tar -C /usr/local -xzvf go$VERSION.$OS-$ARCH.tar.gz &amp;&amp; \\\n    rm go$VERSION.$OS-$ARCH.tar.gz\n\n# setup GO environment\n    echo 'export GOPATH=${HOME}/go' &gt;&gt; ~/.bashrc &amp;&amp; \\\n    echo 'export PATH=/usr/local/go/bin:${PATH}:${GOPATH}/bin' &gt;&gt; ~/.bashrc &amp;&amp; \\\n    source ~/.bashrc\n\n# install dep for dependency resolution\n    go get -u github.com/golang/dep/cmd/dep\n</code></pre>"},{"location":"workflows/#singularity","title":"Singularity","text":"<p>Installation <pre><code>export VERSION=3.0.3 &amp;&amp; # adjust this as necessary \\\n    mkdir -p $GOPATH/src/github.com/sylabs &amp;&amp; \\\n    cd $GOPATH/src/github.com/sylabs &amp;&amp; \\\n    wget https://github.com/sylabs/singularity/releases/download/v${VERSION}/singularity-${VERSION}.tar.gz &amp;&amp; \\\n    tar -xzf singularity-${VERSION}.tar.gz &amp;&amp; \\\n    cd ./singularity &amp;&amp; \\\n    ./mconfig\n</code></pre> Compile <pre><code>./mconfig &amp;&amp; \\\n    make -C ./builddir &amp;&amp; \\\n    sudo make -C ./builddir install\n</code></pre> Singularity cache folder If folder is not set you get this warning:     WARN: Singularity cache directory has not been defined -- Remote image will be stored in the path: /home/sequencing/Analisys/wf-amplicon-demo/work/singularity -- Use the environment variable NXF_SINGULARITY_CACHEDIR to specify a different location</p> <p>To avoid this create cache folder to store downloaded images when running epi2me labs. For each new analysis you run with epi2me make sure to put the image in this folder. <pre><code>mkdir /path/to/singularity-cache-dir\n</code></pre> Create nextflow config file This file will be checked running each wf and redirects singularity to find the images stored locally rather than download them each time. More info on nextflow configuration file. Process: <pre><code>mkdir /home/sequencing/nextflow-config\ntouch /home/sequencing/nextflow-config/nextflow.config\n</code></pre> nextflow.config<pre><code>singularity { \n    enabled = true\n    cacheDir = /path/to/singularity-cache-dir\n} \n</code></pre></p>"},{"location":"workflows/#wf-amplicon","title":"wf-amplicon","text":"<p>This workflow performs the analysis of reads generated from PCR amplicons. After some pre-processing, reads are either aligned to a reference (containing the expected sequence for each amplicon) for variant calling or the amplicon\u2019s consensus sequence is generated de novo.  </p> <p>Installation guides for wf-amplicon can be found here: wf-amplicon Installation guide.  </p>"},{"location":"workflows/#run-the-workflow","title":"Run the workflow","text":"<p>data layout<pre><code>(i)                     (ii)                 (iii)\ninput_reads.fastq   \u2500\u2500\u2500 input_directory  \u2500\u2500\u2500 input_directory\n                        \u251c\u2500\u2500 reads0.fastq     \u251c\u2500\u2500 barcode01\n                        \u2514\u2500\u2500 reads1.fastq     \u2502   \u251c\u2500\u2500 reads0.fastq\n                                             \u2502   \u2514\u2500\u2500 reads1.fastq\n                                             \u251c\u2500\u2500 barcode02\n                                             \u2502   \u251c\u2500\u2500 reads0.fastq\n                                             \u2502   \u251c\u2500\u2500 reads1.fastq\n                                             \u2502   \u2514\u2500\u2500 reads2.fastq\n                                             \u2514\u2500\u2500 barcode03\n                                              \u2514\u2500\u2500 reads0.fastq\n</code></pre> Command to run<pre><code>nextflow run epi2me-labs/wf-amplicon \\\n    --fastq ./fastq \\\n    --reference ./reference.fa \\\n    --sample_sheet ./sample-sheet.csv\n    -c /home/sequencing/nextflow-config/nextflow.config \\\n    -profile singulairy\n</code></pre> Example: sample-sheet.csv<pre><code>barcode,alias,type,ref\nbarcode41,BC41,test_sample,ref1\nbarcode42,BC42,test_sample\nbarcode43,BC43,test_sample,ref2\n</code></pre> Example: reference.fa<pre><code>&gt;ref1\nATGC\n&gt;ref2\nCGTA\n</code></pre></p> <p>Notes</p> <p>When not running variant mode a reference file is not necessary. Also make sure to delete the ref column in that case.</p>"},{"location":"workflows/#links","title":"Links","text":"<ul> <li>Installation EPI2ME</li> <li>Installation Nextflow </li> <li>Installation Singularity </li> <li>Installation Docker</li> <li>Installation GO</li> </ul>"}]}